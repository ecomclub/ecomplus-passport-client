!function(){"use strict";var t=!1;"undefined"!=typeof module&&module.exports&&(t=!0);var u,c,a,l,f,i,p,o,d,e=(l="https://passport.e-com.plus/v1/",f={},i="_passport_session=",p=function(t,e,n){var o="Request to "+t+" failed:\n"+e.status+"\n"+e.responseText,s=new Error(o);console.error(s),n(s,e)},o=function(t,e,n,o,s){var r,i=l+u+"/"+e;window.XDomainRequest?((r=new window.XDomainRequest).ontimeout=r.onerror=function(){p(i,this,s)},r.onload=function(){s(null,this)}):(r=new XMLHttpRequest).onreadystatechange=function(){4===this.readyState&&(200<=this.status&&this.status<300?s(null,this):p(i,this,s))},r.open(t,i,!0),o&&"object"==typeof f.auth&&null!==f.auth&&(r.setRequestHeader("X-My-ID",f.auth.token.my_id),r.setRequestHeader("X-Access-Token",f.auth.token.access_token)),n?(r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(n))):r.send()},{init:function(t,e){u=t,c=e;for(var n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var s=n[o];" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(i)){var r=s.substring(i.length,s.length);try{if("object"==typeof(f=JSON.parse(r))&&null!==f&&!Array.isArray(f))return}catch(t){}return void(f={})}}},session:function(){return f},loginPopup:function(e,t){!function(){a="";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=0;e<32;e++)a+=t.charAt(Math.floor(Math.random()*t.length))}();var n,o=l+c+"/"+u+"/"+a+"/login.html";t&&(o+="?enable_skip=true"),n="object"==typeof screen&&null!==screen?640<=screen.width?640:screen.width:380;var s=window.open(o,"Passport","height=500,width="+n);if(s){window.focus&&s.focus();var r=function(t){clearInterval(i),d(e)};window.passportCallback=function(){r()};var i=setInterval(function(){s.closed&&r()},400)}},logout:function(){f={},document.cookie=i+'"null"'},getSession:d=function(n){o("GET",a+"/token.json",null,!1,function(t,e){t||function(t){try{var e=JSON.parse(t.responseText)}catch(t){console.error(t)}"object"==typeof e&&null!==e&&(f=e,document.cookie=i+JSON.stringify(f))}(e),"function"==typeof n&&n(f.customer)})},api:function(t,e,n,s){"/"!==t.charAt(0)&&(t="/"+t),o(e,"api"+t,n,!0,function(e,n){if("function"==typeof s){var o;if(204===n.status)o=null;else try{o=JSON.parse(n.responseText)}catch(t){e||(e=t),o=n}s(e,o)}else e?console.error(e):console.log(n)})},isLogged:function(){return!(!f.auth||!f.auth.token)},customerObject:function(){return f.customer?f.customer:{}},customerName:function(){return f.customer?f.customer.display_name:""}});t?module.exports=e:window.EcomPassport=e}();
//# sourceMappingURL=passport.min.js.map