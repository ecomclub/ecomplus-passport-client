window.EcomPassport=(function(){var j,a,d;var i="https://passport.e-com.plus/v1/";var f={};var h="_passport_session=";var b=function(){d="";var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var l=0;l<32;l++){d+=k.charAt(Math.floor(Math.random()*k.length))}};var g=function(q,p,l,m,k){var o;if(window.XDomainRequest){o=new window.XDomainRequest();o.onload=function(){k(this)}}else{o=new XMLHttpRequest();o.onreadystatechange=function(){if(this.readyState===4&&this.status===200){k(this)}}}var n=i+j+"/"+d+p;o.open(q,n,true);if(m&&typeof f.auth==="object"&&f.auth!==null){o.setRequestHeader("X-My-ID",f.auth.id);o.setRequestHeader("X-Access-Token",f.auth.token)}if(l){o.send(JSON.stringify(l))}else{o.send()}};var c=function(l){var k=l.responseJSON;if(typeof k==="object"&&k!==null){f=k;document.cookie=h+JSON.stringify(f)}};var e=function(){g("GET","/token.json",null,false,c)};return{init:function(q,o){j=q;a=o;var n=decodeURIComponent(document.cookie);var k=n.split(";");for(var m=0;m<k.length;m++){var r=k[m];while(r.charAt(0)===" "){r=r.substring(1)}if(r.indexOf(h)===0){var l=r.substring(h.length,r.length);try{f=JSON.parse(l);if(typeof f==="object"&&f!==null&&!Array.isArray(f)){return}}catch(p){}f={};return}}},session:function(){return f},loginPopup:function(){b();var m=i+a+"/"+j+"/"+d+"/login.html";var l=window.open(m,"Passport","height=400,width=340");if(window.focus){l.focus()}var n=function(o){clearInterval(k);e()};window.passportCallback=function(){n(true)};var k=setInterval(function(){if(l.closed){n(false)}},400)},getSession:e,isLogged:function(){if(f.auth&&f.auth.token){return true}else{return false}},customerObject:function(){if(f.customer){return f.customer}else{return{}}},customerName:function(){if(f.customer){return f.customer.name}else{return""}}}}());