(function(){var b=false;if(typeof module!=="undefined"&&module.exports){b=true}var a=(function(){var l,c,f;var k="https://passport.e-com.plus/v1/";var i={};var j="_passport_session=";var d=function(){f="";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var o=0;o<32;o++){f+=n.charAt(Math.floor(Math.random()*n.length))}};var m=function(n,o,r){var q="Request to "+n+" failed:\n"+o.status+"\n"+o.responseText;var p=new Error(q);console.error(p);r(p,o)};var h=function(t,r,n,o,s){var p=k+l+"/"+f+r;var q;if(window.XDomainRequest){q=new window.XDomainRequest();q.ontimeout=q.onerror=function(){m(p,this,s)};q.onload=function(){s(null,this)}}else{q=new XMLHttpRequest();q.onreadystatechange=function(){if(this.readyState===4){if(this.status===200){s(null,this)}else{m(p,this,s)}}}}q.open(t,p,true);if(o&&typeof i.auth==="object"&&i.auth!==null){q.setRequestHeader("X-My-ID",i.auth.id);q.setRequestHeader("X-Access-Token",i.auth.token)}if(n){q.send(JSON.stringify(n))}else{q.send()}};var e=function(o){try{var n=JSON.parse(o.responseText)}catch(p){console.error(p)}if(typeof n==="object"&&n!==null){i=n;document.cookie=j+JSON.stringify(i)}};var g=function(n){var o=function(q,p){if(!q){e(p)}if(typeof n==="function"){n(i)}};h("GET","/token.json",null,false,o)};return{init:function(t,r){l=t;c=r;var q=decodeURIComponent(document.cookie);var n=q.split(";");for(var p=0;p<n.length;p++){var u=n[p];while(u.charAt(0)===" "){u=u.substring(1)}if(u.indexOf(j)===0){var o=u.substring(j.length,u.length);try{i=JSON.parse(o);if(typeof i==="object"&&i!==null&&!Array.isArray(i)){return}}catch(s){}i={};return}}},session:function(){return i},loginPopup:function(r){d();var p=k+c+"/"+l+"/"+f+"/login.html";var o=window.open(p,"Passport","height=400,width=340");if(o){if(window.focus){o.focus()}var q=function(s){clearInterval(n);g(r)};window.passportCallback=function(){q(true)};var n=setInterval(function(){if(o.closed){q(false)}},400)}},getSession:g,isLogged:function(){if(i.auth&&i.auth.token){return true}else{return false}},customerObject:function(){if(i.customer){return i.customer}else{return{}}},customerName:function(){if(i.customer){return i.customer.name}else{return""}}}}());if(b){module.exports=a}else{window.EcomPassport=a}}());