(function(){var b=false;if(typeof module!=="undefined"&&module.exports){b=true}var a=(function(){var l,c,f;var k="https://passport.e-com.plus/v1/";var h={};var j="_passport_session=";var d=function(){f="";var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<32;n++){f+=m.charAt(Math.floor(Math.random()*m.length))}};var i=function(s,r,n,o,m){var q;if(window.XDomainRequest){q=new window.XDomainRequest();q.onload=function(){m(this)}}else{q=new XMLHttpRequest();q.onreadystatechange=function(){if(this.readyState===4&&this.status===200){m(this)}}}var p=k+l+"/"+f+r;q.open(s,p,true);if(o&&typeof h.auth==="object"&&h.auth!==null){q.setRequestHeader("X-My-ID",h.auth.id);q.setRequestHeader("X-Access-Token",h.auth.token)}if(n){q.send(JSON.stringify(n))}else{q.send()}};var e=function(n){var m=n.responseJSON;if(typeof m==="object"&&m!==null){h=m;document.cookie=j+JSON.stringify(h)}};var g=function(){i("GET","/token.json",null,false,e)};return{init:function(s,q){l=s;c=q;var p=decodeURIComponent(document.cookie);var m=p.split(";");for(var o=0;o<m.length;o++){var t=m[o];while(t.charAt(0)===" "){t=t.substring(1)}if(t.indexOf(j)===0){var n=t.substring(j.length,t.length);try{h=JSON.parse(n);if(typeof h==="object"&&h!==null&&!Array.isArray(h)){return}}catch(r){}h={};return}}},session:function(){return h},loginPopup:function(){d();var o=k+c+"/"+l+"/"+f+"/login.html";var n=window.open(o,"Passport","height=400,width=340");if(window.focus){n.focus()}var p=function(q){clearInterval(m);g()};window.passportCallback=function(){p(true)};var m=setInterval(function(){if(n.closed){p(false)}},400)},getSession:g,isLogged:function(){if(h.auth&&h.auth.token){return true}else{return false}},customerObject:function(){if(h.customer){return h.customer}else{return{}}},customerName:function(){if(h.customer){return h.customer.name}else{return""}}}}());if(b){module.exports=a}else{window.EcomPassport=a}}());